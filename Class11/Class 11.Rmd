---
title: "Class 11"
author: "Lilith Sadil"
date: "2024-05-07"
output: pdf_document
---

(Jump to section below for homework answers)

## Section 1: Proportion of G/G in a Population

Download a CSV file from ensemble:

<https://useast.ensembl.org/Homo_sapiens/Variation/Sample?db=core;r=17:39894596-39895610;v=rs8067378;vdb=variation;vf=959672880#373531_tablePanel>

Here, we read the CSV file:

```{r}
mxl = read.csv("8067378.csv")
head(mxl)
```

Here, we sum the number of occurances of "G\|G" in the Genotype..forward.strand column of the mxl data set.

```{r}
sum(mxl$Genotype..forward.strand.=="G|G")
```

We can also make a table of these values:

```{r}
table(mxl$Genotype..forward.strand.)
```

The total number of individuals in the dataset are equal to the number of rows in the dataset:

```{r}
nrow(mxl)
```

Now we know that 9 individuals have a G\|G genotype out of 64 individuals

```{r}
9/64*100
```

Our calculation shows that roughly 14% of individuals observed have the G\|G genotype.

Now, we can import the same data from individuals in great britain:

```{r}
gbr = read.csv("8067378_gbr.csv")
gbr
```

## Class 11 Homework

> Q13. Read this file into R and determine the sample size for each genotype and their corresponding median expression levels for each of these genotypes.

```{r}
expr = read.table("class_11_data.txt")
head(expr)
```

```{r}
nrow(expr)
```

There are 462 individuals in the dataset.

```{r}
table(expr$geno)
```

There are 108 individuals with A/A genotype, 233 individuals with an A/G genotype, and 121 individuals with a G/G genotype.

We can now make a box plot to visualize the relative expressions of each genotype. Using summary statistics, we can see that the median expression levels for each genotype are as follows:

-   A/A = 31.250
-   A/G = 25.065
-   G/G = 20.074

```{r}
library(ggplot2)
x = ggplot(expr) + aes(x=geno, y=exp, fill=geno) + geom_boxplot(notch=TRUE) 
summary_stats <- by(expr$exp, expr$geno, summary)
summary_stats
```

> Q14: Generate a boxplot with a box per genotype, what could you infer from the relative expression value between A/A and G/G displayed in this plot? Does the SNP effect the expression of ORMDL3?

From the boxplot generated, the relative expression of ORMDL3 is highest with the A/A genotype, reduced with the A/G genotype, and the lowest among G/G genotypes. Since the notches assigned to each box exhibit no overlap, it is statistically sound to conclude that different genotypes exhibit different levels of ORMDL3 expression. Therefore, this SNP does most likely effect the expression of ORMDL3.

```{r}
library(ggplot2)
ggplot(expr) + aes(x=geno, y=exp, fill=geno) + geom_boxplot(notch=TRUE)
```
